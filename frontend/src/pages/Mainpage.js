import React from "react";
import { Line } from 'react-chartjs-2'

class Mainpage extends React.Component {
    constructor(props) {
        super(props);
    }

    async componentDidMount() {
        let data = await this.readData();
        let table = this.createTable(data);
        document.getElementById("transactions").innerHTML = table;
        console.log(table)
    }

    // Data gets fetched from the backend
    async readData() {
        let data = await fetch('http://localhost:8888/rest/transactions').then(result => result.json());
        return data;
    }

    // create table row for each object within the data array
    createTable(data) {

        let table = [];
        for (let i = data.length - 1; i >= data.length - 10; i--) { 
            //let children = [];
            table += "<tr> <td><a href=Transactiondetails/" + data[i].version + ">" + data[i].version + 
            "</a></td> <td><a href=Accountdetails/" + data[i].sender_id + ">"
                + data[i].sender_id + "</a></td>  <td>" + data[i].public_key + "</td> <td><a href=Accountdetails/" + data[i].receiver_id + ">"
                + data[i].receiver_id + "</a></td>  <td>" + data[i].amount + " " + data[i].currency + "</td> <td>"
                + data[i].gas_used + " " + data[i].gas_currency + "</td> <td>" + data[i].date + "</td> <td>" + data[i].type + "</td> </tr>";
        }
        console.log(data);
        return table;
    }

    render() {

        // var json_object = this.getData();
        // console.log(json_object);

        return (
            <div>
                <h1 id="main_title">Diem Explorer</h1>

                <form class="search">
                    <input type="search" placeholder="Search..." name="search_bar" id="search_bar"></input>
                    {/* <button type="submit" name="search_button" id="search_button"></button> */}
                </form>
                <br></br>
                <br></br>
                <table id="general_information">
                    <caption>General Information</caption>
                    <thead>
                        <tr>
                            <td>Average gas price: </td>
                            <td>Transaction per hour: </td>
                            <td>Hash rate: </td>
                            <td>Market capacity:  Diem USD</td>
                        </tr>
                    </thead>
                </table>
                <br></br>


                <div id="chart-wrapper">
                    <caption>Developments</caption>
                    <Line
                    data={{
                        labels: ['January', 'February', 'March', 'April', 'May', 'June',
                                'July', 'August', 'September', 'October', 'November', 'December'],
                        datasets: [
                            {
                                label: 'Transactions',
                                fill: true,
                                lineTension: 0.5,
                                backgroundColor: '#F0F3F2',
                                borderColor: '#42318C',
                                borderWidth: 2,
                                data: [127, 360, 300, 134, 370, 526, 688, 532, 694, 633, 267, 304, 228, 730, 546, 139, 1, 6, 601, 283, 235, 382, 130, 294, 558, 317, 486, 227, 86, 611, 178, 424, 273, 565, 599, 104, 550, 393, 116, 106, 637, 446, 217, 19, 149, 44, 83, 493, 566, 691, 603, 399, 538, 720, 681, 65, 456, 189, 222, 426, 436, 112, 488, 79, 465, 582, 356, 591, 357, 597, 452, 316, 653, 199, 107, 90, 417, 420, 387, 410, 226, 66, 230, 430, 644, 310, 666, 39, 21, 476, 279, 367, 600, 188, 46, 371, 623, 120, 365, 187, 501, 457, 423, 246, 125, 269, 721, 49, 288, 425, 91, 581, 208, 63, 702, 110, 340, 669, 440, 659, 668, 706, 635, 390, 43, 4, 726, 342, 295, 542, 8, 292, 48, 510, 71, 421, 385, 619, 216, 484, 541, 711, 412, 148, 33, 259, 223, 610, 618, 463, 278, 453, 275, 170, 128, 281, 712, 133, 506, 448, 443, 577, 672, 714, 175, 308, 64, 154, 198, 621, 568, 12, 260, 625, 571, 144, 544, 690, 205, 470, 607, 241, 285, 57, 614, 639, 287, 180, 578, 598, 13, 25, 276, 363, 583, 229, 177, 438, 586, 651, 451, 552, 509, 517, 473, 468, 439, 27, 680, 530, 159, 675, 710, 332, 361, 505, 705, 258, 401, 215, 447, 96, 312, 253, 212, 284, 141, 339, 595, 573, 531, 326, 569, 671, 727, 427, 123, 622, 270, 709, 119, 290, 695, 717, 576, 596, 643, 186, 520, 479, 572, 428, 268, 334, 492, 445, 28, 724, 496, 660, 2, 298, 707, 147, 441, 286, 682, 589, 351, 397, 109, 289, 72, 56, 444, 673, 449, 249, 172, 647, 160, 560, 202, 47, 658, 238, 348, 18, 604, 472, 700, 540, 433, 627, 157, 108, 234, 373, 42, 336, 254, 435, 416, 642, 85, 353, 338, 697, 670, 553, 78, 167, 62, 163, 151, 464, 415, 315, 522, 478, 715, 404, 620, 138, 98, 628, 579, 626, 364, 414, 236, 454, 679, 491, 195, 262, 609, 76, 502, 528, 113, 664, 667, 245, 214, 593, 302, 16, 612, 82, 366, 500, 368, 190, 676, 80, 206, 616, 297, 527, 535, 345, 392, 51, 511, 656, 197, 350, 218, 122, 248, 207, 516, 173, 237, 663, 158, 407, 152, 403, 592, 3, 729, 61, 213, 386, 174, 606, 261, 11, 699, 555, 692, 534, 498, 126, 88, 239, 554, 434, 185, 306, 687, 182, 95, 320, 629, 81, 459, 5, 394, 313, 698, 556, 613, 74, 585, 346, 101, 437, 265, 225, 408, 494, 296, 374, 32, 9, 137, 165, 689, 377, 240, 299, 499, 161, 26, 477, 321, 422, 325, 7, 244, 183, 102, 14, 518, 93, 89, 135, 97, 23, 514, 100, 719, 594, 257, 567, 662, 30, 352, 471, 142, 630, 266, 380, 575, 570, 557, 640, 487, 406, 291, 372, 646, 617, 274, 388, 341, 45, 405, 319, 396, 231, 462, 17, 467, 221, 523, 171, 251, 92, 693, 247, 483, 469, 548, 264, 458, 272, 602, 513, 519, 280, 395, 431, 411, 701, 718, 58, 242, 329, 54, 536, 169, 155, 59, 495, 650, 156, 204, 327, 203, 318, 580, 309, 243, 590, 391, 521, 450, 409, 529, 129, 121, 503, 337, 200, 362, 563, 649, 497, 507, 379, 539, 322, 547, 150, 117, 684, 359, 665, 10, 685, 60, 638, 252, 37, 99, 474, 686, 162, 67, 53, 641, 723, 537, 455, 293, 605, 402, 349, 419, 211, 22, 232, 168, 489, 704, 140, 166, 75, 696, 432, 725, 179, 131, 50, 146, 378, 31, 389, 36, 343, 564, 219, 383, 545, 15, 328, 574, 562, 233, 344, 77, 303, 307, 314, 645, 124, 475, 549, 145, 87, 333, 69, 634, 331, 111, 615, 559, 661, 35, 143, 40, 271, 224, 136, 482, 29, 335, 323, 153, 256, 68, 648, 347, 358, 201, 375, 114, 193, 191, 184, 118, 588, 683, 624, 703, 466, 677, 678, 561, 654, 176, 655, 490, 20, 354, 485, 355, 442, 52, 551, 41, 384, 196, 369, 210, 24, 413, 105, 587, 263, 103, 38, 192, 533, 250, 255, 220, 543, 728, 209, 429, 631, 722, 181, 73, 324, 713, 418, 34, 330, 652, 132, 716, 504, 481, 512, 525, 657, 515, 608, 480, 115, 400, 636, 508, 70, 84, 376, 55, 164, 584, 398, 460, 282, 461, 524, 674, 632, 94, 381, 305, 311, 277, 194, 708, 301]
                            },
                            {
                                label: 'Accounts',
                                fill: true,
                                lineTension: 0.5,
                                backgroundColor: '#F0F3F2',
                                borderColor: '#42318C',
                                borderWidth: 2,
                                data: [22, 411, 444, 479, 486, 516, 275, 619, 654, 255, 239, 124, 688, 609, 16, 311, 165, 13, 34, 385, 414, 533, 230, 428, 351, 618, 28, 399, 199, 261, 651, 316, 21, 37, 432, 283, 42, 116, 612, 302, 265, 650, 203, 170, 388, 481, 715, 231, 86, 159, 655, 57, 125, 626, 617, 628, 702, 300, 309, 695, 467, 136, 526, 349, 202, 456, 507, 278, 169, 505, 425, 201, 173, 511, 224, 119, 72, 73, 100, 161, 98, 452, 189, 234, 24, 549, 657, 656, 514, 623, 729, 129, 177, 544, 95, 419, 69, 348, 350, 697, 458, 668, 346, 276, 196, 571, 561, 341, 147, 374, 482, 158, 213, 392, 131, 678, 15, 115, 305, 599, 138, 137, 625, 358, 415, 63, 633, 8, 215, 646, 229, 490, 709, 200, 578, 284, 405, 371, 384, 152, 552, 2, 65, 710, 319, 662, 439, 400, 716, 581, 273, 706, 642, 627, 312, 49, 76, 7, 666, 144, 160, 487, 545, 225, 327, 644, 387, 630, 502, 377, 270, 41, 639, 56, 638, 641, 562, 497, 3, 440, 344, 534, 240, 592, 559, 539, 237, 527, 555, 712, 591, 510, 469, 692, 560, 75, 171, 564, 277, 506, 647, 418, 721, 150, 206, 5, 450, 139, 474, 542, 343, 649, 262, 572, 246, 529, 87, 442, 691, 667, 307, 211, 62, 466, 60, 154, 79, 209, 431, 498, 118, 495, 582, 682, 593, 423, 363, 235, 286, 297, 604, 156, 194, 185, 117, 289, 632, 659, 109, 576, 492, 370, 299, 53, 132, 427, 227, 274, 99, 141, 176, 652, 410, 531, 26, 217, 322, 355, 333, 68, 402, 583, 223, 724, 519, 471, 220, 244, 594, 473, 707, 164, 332, 515, 334, 285, 268, 357, 253, 180, 33, 483, 107, 192, 472, 221, 523, 146, 426, 669, 36, 43, 91, 90, 383, 550, 664, 620, 720, 493, 535, 55, 660, 241, 123, 38, 598, 386, 155, 214, 70, 280, 614, 394, 175, 465, 580, 92, 615, 149, 521, 711, 365, 320, 120, 187, 677, 429, 381, 267, 287, 449, 459, 589, 568, 212, 687, 362, 376, 675, 313, 102, 461, 464, 512, 29, 77, 708, 416, 393, 503, 689, 508, 698, 636, 727, 447, 463, 477, 605, 133, 93, 30, 179, 705, 517, 435, 565, 352, 380, 699, 714, 548, 338, 367, 264, 700, 71, 354, 254, 61, 204, 298, 518, 648, 629, 112, 557, 596, 294, 538, 291, 269, 12, 272, 665, 258, 183, 130, 197, 704, 730, 468, 404, 537, 389, 250, 478, 140, 575, 89, 317, 106, 260, 153, 420, 353, 422, 491, 303, 190, 359, 347, 184, 321, 292, 148, 32, 18, 166, 722, 135, 574, 390, 725, 9, 263, 520, 676, 522, 451, 67, 634, 259, 373, 372, 446, 573, 6, 457, 94, 339, 566, 336, 66, 96, 462, 408, 151, 105, 480, 162, 382, 611, 83, 543, 54, 48, 195, 88, 470, 369, 679, 58, 104, 595, 475, 681, 168, 613, 11, 52, 579, 554, 59, 684, 51, 342, 226, 391, 233, 279, 635, 701, 670, 335, 607, 191, 329, 375, 218, 20, 163, 433, 601, 128, 301, 97, 532, 1, 288, 504, 23, 407, 315, 476, 219, 536, 296, 35, 546, 266, 318, 525, 637, 551, 74, 610, 193, 330, 174, 395, 401, 325, 530, 454, 361, 622, 50, 685, 683, 108, 409, 673, 121, 113, 397, 585, 728, 142, 488, 331, 499, 489, 485, 406, 541, 295, 513, 570, 417, 40, 719, 44, 145, 443, 228, 460, 167, 726, 658, 368, 110, 222, 47, 27, 448, 694, 172, 242, 178, 256, 248, 19, 494, 455, 80, 64, 198, 653, 528, 723, 597, 306, 398, 127, 693, 421, 84, 324, 360, 569, 101, 686, 328, 430, 379, 122, 671, 114, 556, 340, 157, 567, 608, 524, 134, 588, 337, 631, 4, 403, 621, 445, 356, 290, 396, 501, 326, 45, 208, 39, 413, 251, 366, 236, 661, 586, 663, 364, 645, 412, 674, 249, 624, 10, 672, 126, 577, 696, 14, 424, 680, 718, 245, 540, 616, 111, 436, 304, 590, 345, 293, 282, 271, 232, 606, 252, 238, 453, 323, 247, 216, 437, 82, 210, 640, 603, 703, 182, 181, 438, 441, 143, 602, 78, 713, 257, 17, 509, 563, 600, 25, 584, 717, 243, 207, 484, 188, 205, 496, 643, 553, 310, 587, 85, 308, 547, 378, 314, 500, 434, 558, 281, 81, 690, 31, 46, 103, 186]
                            },
                            {
                                label: 'Gas price',
                                fill: true,
                                lineTension: 0.5,
                                backgroundColor: '#F0F3F2',
                                borderColor: '#42318C',
                                borderWidth: 2,
                                data: [373, 550, 590, 239, 207, 539, 672, 515, 427, 303, 201, 116, 45, 460, 611, 419, 534, 665, 315, 77, 490, 58, 495, 563, 219, 327, 53, 568, 507, 477, 487, 724, 47, 406, 638, 27, 694, 621, 107, 407, 301, 204, 655, 641, 217, 677, 244, 426, 498, 206, 192, 681, 624, 94, 115, 423, 166, 456, 275, 663, 435, 661, 628, 602, 608, 599, 612, 709, 444, 480, 546, 254, 500, 264, 29, 642, 178, 441, 282, 34, 470, 142, 627, 647, 202, 120, 440, 99, 560, 288, 3, 56, 633, 51, 313, 502, 414, 112, 393, 20, 66, 253, 725, 553, 181, 75, 618, 146, 276, 220, 156, 132, 305, 172, 579, 139, 83, 454, 402, 535, 302, 570, 693, 400, 249, 134, 606, 278, 326, 271, 528, 537, 696, 19, 643, 24, 273, 289, 363, 265, 78, 54, 389, 197, 262, 189, 421, 644, 190, 639, 345, 4, 102, 188, 712, 215, 710, 57, 605, 26, 335, 438, 698, 163, 104, 151, 60, 270, 503, 523, 76, 371, 525, 73, 324, 238, 154, 562, 635, 11, 170, 157, 208, 7, 290, 381, 295, 128, 344, 180, 485, 309, 475, 23, 137, 168, 243, 356, 329, 229, 636, 541, 237, 148, 95, 566, 186, 336, 436, 149, 554, 670, 195, 106, 100, 198, 89, 92, 531, 353, 218, 401, 9, 256, 574, 14, 361, 410, 514, 274, 1, 308, 450, 109, 52, 412, 467, 482, 280, 730, 581, 685, 164, 222, 135, 2, 556, 299, 437, 98, 177, 588, 96, 378, 610, 453, 577, 397, 476, 91, 496, 80, 372, 499, 211, 330, 159, 483, 43, 594, 727, 668, 536, 338, 126, 704, 521, 701, 529, 653, 625, 322, 140, 433, 478, 5, 552, 147, 110, 664, 292, 484, 683, 613, 316, 74, 548, 558, 235, 688, 365, 127, 385, 607, 561, 357, 585, 449, 283, 298, 518, 187, 341, 155, 462, 542, 649, 660, 141, 123, 307, 158, 38, 459, 62, 474, 70, 559, 719, 255, 227, 417, 697, 472, 213, 240, 8, 179, 405, 652, 540, 193, 174, 346, 468, 358, 666, 97, 261, 637, 150, 252, 37, 85, 21, 374, 662, 153, 443, 370, 183, 714, 199, 12, 569, 184, 543, 431, 281, 384, 64, 415, 267, 620, 615, 87, 386, 317, 13, 169, 703, 364, 729, 392, 101, 501, 17, 342, 225, 578, 404, 493, 682, 349, 675, 200, 473, 538, 686, 527, 228, 601, 640, 430, 113, 223, 31, 165, 723, 334, 360, 532, 705, 720, 511, 434, 259, 55, 388, 49, 506, 623, 118, 318, 394, 68, 319, 321, 721, 269, 224, 399, 119, 71, 691, 136, 221, 285, 6, 684, 210, 692, 674, 251, 424, 268, 522, 257, 175, 517, 716, 718, 81, 651, 152, 669, 708, 312, 494, 632, 131, 125, 375, 130, 203, 557, 176, 332, 10, 33, 510, 108, 707, 505, 673, 287, 413, 242, 526, 583, 35, 291, 626, 695, 310, 466, 592, 451, 544, 630, 547, 396, 555, 191, 452, 520, 551, 84, 209, 488, 16, 680, 36, 205, 241, 250, 347, 82, 160, 231, 409, 576, 245, 702, 144, 722, 42, 448, 432, 398, 654, 584, 79, 277, 631, 248, 726, 564, 650, 671, 246, 479, 337, 411, 425, 67, 121, 416, 65, 728, 658, 41, 167, 646, 604, 377, 586, 369, 492, 352, 293, 486, 236, 296, 571, 114, 509, 117, 609, 133, 234, 171, 233, 44, 533, 582, 634, 390, 300, 93, 350, 575, 46, 362, 230, 439, 418, 445, 15, 587, 279, 343, 380, 512, 61, 263, 715, 340, 700, 216, 143, 145, 593, 676, 297, 464, 589, 469, 524, 86, 161, 196, 173, 40, 687, 284, 383, 598, 272, 328, 513, 596, 657, 717, 489, 354, 690, 367, 447, 403, 214, 72, 491, 247, 379, 429, 28, 88, 331, 591, 395, 565, 667, 465, 471, 455, 595, 376, 105, 366, 580, 314, 645, 457, 325, 428, 260, 32, 111, 103, 185, 266, 648, 304, 258, 232, 226, 603, 124, 442, 497, 481, 572, 461, 699, 48, 30, 458, 706, 619, 212, 549, 22, 18, 387, 294, 194, 286, 351, 463, 420, 323, 122, 355, 25, 63, 90, 516, 446, 711, 678, 129, 530, 422, 616, 182, 368, 629, 713, 382, 138, 656, 162, 689, 600, 567, 50, 545, 659, 573, 519, 408, 617, 348, 679, 504, 508, 622, 597, 311, 69, 339, 391, 320, 59, 614, 359, 306, 333, 39]
                            }
                        ]
                    }}
                    options={{
                        maintainAspectRatio: false,
                        options: {
                            // tooltips: {
                            //    mode: 'index',
                            //    intersect: false
                            // },
                            // hover: {
                            //    mode: 'index',
                            //    intersect: false
                            // }
                         }
                    }}
                    />
                </div>
                <br></br>
                <br></br>
                <br></br>


                <table>
                    <caption>Latest Transactions</caption>
                    <thead>
                        <tr>
                            <th>Version</th>
                            <th>From</th>
                            <th>Public Key Sender</th>
                            <th>To</th>
                            <th>Amount</th>
                            <th>Gas Amount</th>
                            <th>Date</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody id="transactions"></tbody>
                </table>
                <br></br>
                <br></br>
            </div>
        );
    }
}
export default Mainpage;
